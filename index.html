<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Analisi Climatica - Vercelli</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
  <style>
    :root {
      --main-color: #2c3e50;
      --accent-color: #3498db;
      --light-gray: #f4f4f4;
      --warning-color: #f39c12; /* Orange for socio-economic impacts */
      --danger-color: #e74c3c; /* Red for high severity */
      --success-color: #27ae60; /* Green for low severity/positive */
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: var(--light-gray);
      color: #333;
    }
    header {
      background: var(--main-color);
      color: white;
      padding: 20px 0;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    nav {
      background: #1c2833;
      display: flex;
      justify-content: center;
      padding: 10px 0;
      flex-wrap: wrap;
    }
    nav a {
      color: white;
      margin: 0 15px;
      text-decoration: none;
      font-weight: bold;
      padding: 5px 0;
    }
    nav a:hover {
      text-decoration: underline;
    }
    #map {
      height: 60vh;
      width: 100%;
      margin-bottom: 30px;
    }
    .content {
      padding: 30px;
      max-width: 1000px;
      margin: auto;
    }
    h2 {
      color: var(--main-color);
      border-bottom: 2px solid var(--accent-color);
      padding-bottom: 5px;
      margin-top: 40px;
    }
    .info-box, .info-box-socio, .interactive-section {
      background: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      /* Removed cursor: pointer; from info-box as content is always visible */
      overflow: hidden;
    }
    .info-box ul, .info-box-socio ul {
      padding-left: 20px;
      list-style: none;
      margin-top: 15px;
    }
    .info-box ul li, .info-box-socio ul li {
      margin-bottom: 8px;
      line-height: 1.6em;
      display: list-item; /* Always visible */
    }
    .info-box i {
      margin-right: 6px;
      color: var(--accent-color);
    }
    .info-box-socio {
      background: #fff9e6;
      border-left: 6px solid var(--warning-color);
      /* Specific override for h2 border color within this section */
    }
    .info-box-socio h2 {
        border-bottom-color: var(--warning-color);
    }
    .chart {
      margin: 25px auto;
      text-align: center;
    }
    footer {
      background: #2c3e50;
      color: white;
      text-align: center;
      padding: 10px;
      font-size: 0.9em;
      margin-top: 40px;
    }
    /* Styles for graphs - always visible */
    .graphs-section {
      margin-top: 20px;
      border-top: 1px solid #eee;
      padding-top: 20px;
      text-align: center;
      display: block; /* Always visible */
    }
    .graphs-section img {
      max-width: 100%;
      height: auto;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      cursor: pointer;
    }
    .graphs-section h3 {
      color: var(--accent-color);
      margin-bottom: 10px;
      font-size: 1.1em;
    }

    /* Modal (Lightbox) Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      padding-top: 60px;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgb(0,0,0);
      background-color: rgba(0,0,0,0.9);
    }
    .modal-content {
      margin: auto;
      display: block;
      width: 80%;
      max-width: 900px;
    }
    #caption {
      margin: auto;
      display: block;
      width: 80%;
      max-width: 900px;
      text-align: center;
      color: #ccc;
      padding: 10px 0;
      height: 150px;
    }
    .modal-content, #caption {
      animation-name: zoom;
      animation-duration: 0.6s;
    }
    @keyframes zoom {
      from {transform:scale(0)}
      to {transform:scale(1)}
    }
    .close-button {
      position: absolute;
      top: 15px;
      right: 35px;
      color: #f1f1f1;
      font-size: 40px;
      font-weight: bold;
      transition: 0.3s;
    }
    .close-button:hover,
    .close-button:focus {
      color: #bbb;
      text-decoration: none;
      cursor: pointer;
    }
    @media only screen and (max-width: 700px){
      .modal-content {
        width: 100%;
      }
    }

    /* Interactive Section Styles */
    .interactive-section {
      background: #e6f7ff;
      border-left: 6px solid var(--accent-color);
      padding: 30px;
      margin-top: 40px;
    }
    .interactive-section h2 {
      color: var(--main-color);
      border-bottom-color: var(--accent-color);
    }
    .interactive-controls {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-bottom: 30px;
    }
    .control-group {
      display: flex;
      flex-direction: column;
    }
    .control-group label {
      font-weight: bold;
      margin-bottom: 10px;
      color: var(--main-color);
    }
    .control-group input[type="range"] {
      width: 100%;
      -webkit-appearance: none;
      height: 8px;
      background: #ddd;
      border-radius: 5px;
      outline: none;
      opacity: 0.7;
      transition: opacity .2s;
    }
    .control-group input[type="range"]:hover {
      opacity: 1;
    }
    .control-group input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      background: var(--accent-color);
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0,0,0,0.2);
    }
    .control-group input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      background: var(--accent-color);
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0,0,0,0.2);
    }
    .control-value {
      text-align: center;
      font-weight: bold;
      color: var(--accent-color);
      margin-top: 5px;
    }
    .impact-results {
      background: white;
      padding: 25px;
      border-radius: 8px;
      box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
    }
    .impact-results h3 {
      color: var(--main-color);
      margin-bottom: 15px;
      font-size: 1.2em;
    }
    .impact-category {
      margin-bottom: 20px;
    }
    .impact-category h4 {
      color: var(--warning-color);
      margin-bottom: 10px;
      font-size: 1.1em;
    }
    .impact-category p {
      line-height: 1.6em;
      color: #555;
    }
    .impact-category.positive h4 { color: var(--success-color); }
    .impact-category.negative h4 { color: var(--danger-color); }

    /* New styles for Impact Cards */
    .impacts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); /* Responsive grid */
      gap: 25px;
      margin-top: 30px;
    }

    .impact-card {
      background: #f9f9f9;
      border-left: 5px solid var(--warning-color); /* Default warning color for impact */
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
      cursor: default;
    }

    .impact-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
    }

    .impact-card .icon-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }

    .impact-card .impact-icon {
      font-size: 2.5em;
      margin-right: 15px;
      color: var(--warning-color); /* Default color, can be overridden by severity classes */
    }
    /* Severity Indicators for icons */
    .impact-icon.severity-low { color: var(--success-color); }
    .impact-icon.severity-medium { color: var(--warning-color); }
    .impact-icon.severity-high { color: var(--danger-color); }

    .impact-card h3 {
      color: var(--main-color);
      margin: 0;
      font-size: 1.3em;
    }

    .impact-card .impact-summary {
      font-style: italic;
      color: #777;
      margin-bottom: 15px;
    }

    .impact-card .impact-details {
      border-top: 1px dashed #eee;
      padding-top: 15px;
      font-size: 0.95em;
      color: #555;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      nav {
        flex-direction: column;
        align-items: center;
      }
      nav a {
        margin: 5px 0;
      }
      .content {
        padding: 15px;
      }
      .interactive-controls {
        flex-direction: column;
      }
      .impacts-grid {
        grid-template-columns: 1fr; /* Single column on smaller screens */
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Analisi Climatica e Impatti Socio-Economici - Vercelli</h1>
    <p>Uno sguardo integrato ai cambiamenti climatici sul territorio vercellese</p>
  </header>
  <nav>
    <a href="#minime">Temperature Minime</a>
    <a href="#massime">Temperature Massime</a>
    <a href="#precipitazioni">Precipitazioni</a>
    <a href="#impatto">Impatto Socio-Economico</a>
    <a href="#simulatore">Simulatore di Impatto</a>
  </nav>

  <div id="map"></div>

  <div class="content">
    <div id="minime" class="info-box">
      <h2>📊 Temperature Minime</h2>
      <ul>
        <li><i class="fas fa-temperature-low"></i> <strong>TR</strong> – Le notti tropicali (Tmin > 20°C) sono in forte aumento. Questo fenomeno riduce il raffrescamento notturno, aumentando consumi energetici e stress termico sia per l'uomo che per le colture.</li>
        <li><i class="fas fa-snowflake"></i> <strong>TN10p</strong> – La riduzione delle notti molto fredde (10° percentile) implica meno gelate, ma anche meno controllo naturale di parassiti, con conseguenze per la salute delle colture.</li>
        <li><i class="fas fa-moon"></i> <strong>TN90p</strong> – L’incremento delle notti estremamente calde altera i ritmi fisiologici delle colture, anticipa le fasi vegetative e aumenta il consumo idrico.</li>
      </ul>
      <div class="graphs-section">
        <h3>Grafici Indici Temperature Minime</h3>
        <img src="Vercelli_94_24_tr_ANN.png" alt="Grafico TR - Notti Tropicali" class="enlargeable-graph">
        <img src="Vercelli_94_24_tn10p_ANN.png" alt="Grafico TN10p - Notti Fredde" class="enlargeable-graph">
        <img src="Vercelli_94_24_tn90p_ANN.png" alt="Grafico TN90p - Notti Calde Estive" class="enlargeable-graph">
      </div>
    </div>

    <div id="massime" class="info-box">
      <h2>🔥 Temperature Massime</h2>
      <ul>
        <li><i class="fas fa-sun"></i> <strong>TX90p</strong> – I giorni con Tmax > 90° percentile sono in crescita costante. Questo peggiora la vivibilità estiva e aumenta i costi per la climatizzazione e irrigazione.</li>
        <li><i class="fas fa-burn"></i> <strong>HWN / HWF</strong> – Più eventi di ondate di calore e più lunghi: impatti sanitari e produttivi su tutta la comunità, con effetti cumulativi che amplificano il danno.</li>
        <li><i class="fas fa-thermometer-full"></i> <strong>TXGE30</strong> – L’aumento dei giorni oltre i 30°C crea condizioni di caldo continuo che compromettono le fasi critiche di crescita agricola.</li>
      </ul>
      <div class="graphs-section">
        <h3>Grafici Indici Temperature Massime</h3>
        <img src="Vercelli_94_24_tx90p_ANN.png" alt="Grafico TX90p - Giorni Caldi Estremi" class="enlargeable-graph">
        <img src="Vercelli_94_24_hwf_tx90_ANN.png" alt="Grafico HWF-Tx90 - Frequenza Ondate di Calore" class="enlargeable-graph">
        <img src="Vercelli_94_24_hwn_tx90_ANN.png" alt="Grafico HWN-Tx90 - Durata Ondate di Calore" class="enlargeable-graph">
        <img src="Vercelli_94_24_txge30_ANN.png" alt="Grafico TXGE30 - Giorni oltre 30°C" class="enlargeable-graph">
      </div>
    </div>

    <div id="precipitazioni" class="info-box">
      <h2>🌧️ Precipitazioni</h2>
      <ul>
        <li><i class="fas fa-cloud-sun-rain"></i> <strong>CDD</strong> – I periodi consecutivi senza pioggia superano spesso i 30 giorni: questo indebolisce la resilienza idrica delle colture e aumenta il rischio di perdite nel riso.</li>
        <li><i class="fas fa-water"></i> <strong>PRCPTOT</strong> – Il totale annuale resta stabile, ma la distribuzione è più irregolare e meno utile all’agricoltura.</li>
        <li><i class="fas fa-cloud-showers-heavy"></i> <strong>R95p</strong> – Le piogge intense e concentrate causano allagamenti, erosione e inefficienza nella ricarica idrica dei terreni agricoli.</li>
      </ul>
      <div class="graphs-section">
        <h3>Grafici Indici Precipitazioni</h3>
        <img src="Vercelli_94_24_cdd_ANN.png" alt="Grafico CDD - Giorni Secchi Consecutivi" class="enlargeable-graph">
        <img src="Vercelli_94_24_prcptot_ANN.png" alt="Grafico PRCPTOT - Precipitazioni Totali Annuali" class="enlargeable-graph">
        <img src="Vercelli_94_24_r95p_ANN.png" alt="Grafico R95p - Precipitazioni Estreme" class="enlargeable-graph">
      </div>
    </div>

    <div id="impatto" class="info-box-socio">
      <h2>🌱 Impatti sul Tessuto Socio-Economico</h2>
      <p>Il cambiamento climatico sta già alterando in modo tangibile l’equilibrio socio-economico del vercellese, in particolare per un’economia agricola fortemente specializzata. Gli scenari futuri indicano una crescente urgenza nell'adottare strategie di mitigazione e adattamento per preservare la qualità della vita e la prosperità economica del territorio.</p>

      <div class="impacts-grid">
        <div class="impact-card">
          <div class="icon-header">
            <i class="fas fa-hand-holding-water impact-icon severity-high"></i>
            <h3>Costi Irrigui e Stress Idrico</h3>
          </div>
          <p class="impact-summary">L'aumento dei periodi di siccità e la maggiore irregolarità delle precipitazioni incrementano drasticamente la domanda di irrigazione, con conseguente innalzamento dei costi e pressione sulle risorse idriche.</p>
          <div class="impact-details">
            <p>I dati sugli indici climatici mostrano un aumento significativo dei **Giorni Secchi Consecutivi (CDD)** e una distribuzione anomala delle precipitazioni totali (**PRCPTOT**), con eventi estremi (**R95p**) che non permettono una ricarica efficace delle falde. Questo scenario costringe gli agricoltori vercellesi, in particolare quelli legati alla coltivazione del riso, ad affrontare spese maggiori per l'approvvigionamento e la gestione dell'acqua, riducendo i margini di profitto e rendendo l'attività più precaria. La dipendenza da fonti idriche stabili e la competizione per l'acqua potrebbero diventare criticità maggiori.</p>
          </div>
        </div>

        <div class="impact-card">
          <div class="icon-header">
            <i class="fas fa-user-injured impact-icon severity-high"></i>
            <h3>Rischi Sanitari e Disagio Urbano</h3>
          </div>
          <p class="impact-summary">L'intensificarsi delle ondate di calore e delle notti tropicali rappresenta una seria minaccia per la salute pubblica e il benessere dei cittadini.</p>
          <div class="impact-details">
            <p>L'incremento delle **Notti Tropicali (TR)**, dei giorni con **Temperature Massime estreme (TX90p)** e della **Frequenza/Durata delle Ondate di Calore (HWF/HWN)**, come evidenziato dai grafici, impedisce il recupero fisiologico durante le ore notturne. Questo porta a un aumento di colpi di calore, disidratazione e aggravamento di patologie cardiovascolari e respiratorie, specialmente tra anziani, bambini e lavoratori all'aperto. Le "isole di calore urbane" amplificano il problema, mettendo sotto pressione i servizi sanitari locali.</p>
          </div>
        </div>

        <div class="impact-card">
          <div class="icon-header">
            <i class="fas fa-handshake-slash impact-icon severity-medium"></i>
            <h3>Vulnerabilità Economica Agricola</h3>
          </div>
          <p class="impact-summary">Le piccole e medie imprese agricole faticano ad adattarsi ai rapidi cambiamenti climatici, compromettendo la loro sostenibilità economica e competitività.</p>
          <div class="impact-details">
            <p>La minor frequenza di notti fredde (**TN10p**) altera il ciclo di vita dei parassiti, mentre le temperature costantemente elevate (**TXGE30**) e le notti calde (**TN90p**) stressano le colture durante le fasi critiche di crescita. Queste condizioni richiedono investimenti significativi in nuove tecnologie agricole, varietà resilienti e strategie di gestione integrate che spesso superano le capacità finanziarie delle piccole aziende. Ciò può portare a una riduzione della redditività, all'indebitamento e, nei casi peggiori, alla chiusura delle attività, con ripercussioni negative sull'occupazione e sul PIL locale.</p>
          </div>
        </div>

        <div class="impact-card">
          <div class="icon-header">
            <i class="fas fa-chart-line impact-icon severity-medium"></i>
            <h3>Competitività e Sicurezza Alimentare</h3>
          </div>
          <p class="impact-summary">La riduzione delle rese e l'alterazione dei cicli colturali minacciano la competitività dei prodotti agricoli di Vercelli e la sicurezza alimentare locale.</p>
          <div class="impact-details">
            <p>L'instabilità delle precipitazioni e le temperature estreme influenzano direttamente la quantità e la qualità dei raccolti. Ad esempio, periodi di siccità prolungata (**CDD**) possono compromettere la germinazione del riso, mentre piogge torrenziali (**R95p**) possono causare allettamento e danni fisici alle colture mature. Questi fattori si traducono in minori volumi di produzione, standard qualitativi inferiori e costi di recupero maggiori, rendendo i prodotti vercellesi meno attrattivi sui mercati nazionali e internazionali e potenzialmente compromettendo l'autosufficienza alimentare locale.</p>
          </div>
        </div>

        <div class="impact-card">
          <div class="icon-header">
            <i class="fas fa-city impact-icon severity-medium"></i>
            <h3>Pianificazione Territoriale e Infrastrutture</h3>
          </div>
          <p class="impact-summary">La crescente frequenza di eventi climatici estremi impone una revisione urgente delle strategie di pianificazione urbana e rurale e degli investimenti infrastrutturali.</p>
          <div class="impact-details">
            <p>L'aumento delle piogge intense (**R95p**) richiede sistemi di drenaggio più efficienti e nuove strategie per la gestione del rischio idrogeologico, inclusa la manutenzione di argini e canali. Le ondate di calore più intense e prolungate (**HWF/HWN**) sollecitano la necessità di "infrastrutture verdi" (parchi, alberi, tetti verdi) nelle aree urbane per mitigare l'effetto isola di calore. La pianificazione deve considerare la resilienza di strade, edifici e reti di servizio, implicando investimenti significativi e un approccio integrato tra settori.</p>
          </div>
        </div>
      </div>

      <div class="chart">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/02/Climate_change_graph_%282020%29.png/600px-Climate_change_graph_%282020%29.png" alt="Grafico cambiamento climatico globale" width="90%">
        <p style="font-size: 0.85em; color: #666;">Fonte: Wikimedia Commons – Andamento globale delle temperature medie (dal 1880 al 2020)</p>
      </div>
    </div>

    <div id="simulatore" class="interactive-section">
      <h2>🌍 Simulatore di Impatto Climatico su Vercelli</h2>
      <p>Esplora come diversi scenari climatici potrebbero influenzare il territorio di Vercelli. Muovi i cursori per vedere gli impatti stimati su diversi settori. Questo simulatore fornisce un'indicazione basata su modelli semplificati e non sostituisce analisi climatiche approfondite.</p>

      <div class="interactive-controls">
        <div class="control-group">
          <label for="temp-slider">Aumento Temperatura Media Annuale (°C): <span id="temp-value">0.0</span></label>
          <input type="range" id="temp-slider" min="0" max="4" step="0.5" value="0">
        </div>
        <div class="control-group">
          <label for="precip-slider">Variazione Precipitazioni Annue Totali (%): <span id="precip-value">0</span></label>
          <input type="range" id="precip-slider" min="-30" max="30" step="5" value="0">
        </div>
      </div>

      <div class="impact-results">
        <h3>Impatti Stimati sul Futuro di Vercelli:</h3>
        <div class="impact-category" id="impact-people">
          <h4><i class="fas fa-users"></i> Impatto sulle Persone e la Salute</h4>
          <p>Seleziona i parametri per visualizzare l'impatto.</p>
        </div>
        <div class="impact-category" id="impact-agriculture">
          <h4><i class="fas fa-seedling"></i> Impatto sul Settore Agricolo e l'Ambiente</h4>
          <p>Seleziona i parametri per visualizzare l'impatto.</p>
        </div>
        <div class="impact-category" id="impact-economy">
          <h4><i class="fas fa-chart-line"></i> Impatto Economico e Sociale</h4>
          <p>Seleziona i parametri per visualizzare l'impatto.</p>
        </div>
      </div>
    </div>

  </div>

  <footer>
    Progetto realizzato per analisi territoriale climatica | Master 2025 - Vercelli
  </footer>

  <button onclick="scrollToTop()" style="position: fixed; bottom: 20px; left: 20px; padding: 10px 15px; background-color: #3498db; color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 2px 6px rgba(0,0,0,0.3); font-size: 16px;">
    ⬆ Torna su
  </button>

  <div id="imageModal" class="modal">
    <span class="close-button">&times;</span>
    <img class="modal-content" id="img01">
    <div id="caption" class="caption"></div>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const map = L.map('map').setView([45.32, 8.42], 10);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    const layers = [
      {
        name: "Zona Risaie",
        coords: [45.25, 8.52],
        descrizione: "Area vulnerabile alla siccità estiva (CDD) e alla gestione idrica complessa."
      },
      {
        name: "Area Urbana di Vercelli",
        coords: [45.32, 8.42],
        descrizione: "Popolazione esposta all'effetto isola di calore e ai picchi termici prolungati."
      },
      {
        name: "Zona Mais e Frumento",
        coords: [45.35, 8.30],
        descrizione: "A rischio di squilibri termici in primavera e piogge estreme dannose."
      }
    ];

    layers.forEach(zona => {
      L.circle(zona.coords, {
        color: '#e74c3c',
        fillColor: '#e74c3c',
        fillOpacity: 0.5,
        radius: 4000
      }).addTo(map).bindPopup(`<b>${zona.name}</b><br>${zona.descrizione}`);
    });

    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Lightbox functionality
    const modal = document.getElementById("imageModal");
    const modalImg = document.getElementById("img01");
    const captionText = document.getElementById("caption");
    const closeButton = document.getElementsByClassName("close-button")[0];

    document.querySelectorAll('.graphs-section img').forEach(img => {
      img.addEventListener('click', function(event){
        event.stopPropagation(); // Prevent any parent click listeners from firing
        modal.style.display = "block";
        modalImg.src = this.src;
        captionText.innerHTML = this.alt;
      });
    });

    closeButton.onclick = function() {
      modal.style.display = "none";
    }

    modal.addEventListener('click', function(event) {
      if (event.target === modal) {
        modal.style.display = "none";
      }
    });

    // Interactive Impact Simulator
    const tempSlider = document.getElementById('temp-slider');
    const tempValueSpan = document.getElementById('temp-value');
    const precipSlider = document.getElementById('precip-slider');
    const precipValueSpan = document.getElementById('precip-value');

    const impactPeople = document.getElementById('impact-people');
    const impactAgriculture = document.getElementById('impact-agriculture');
    const impactEconomy = document.getElementById('impact-economy');

    function updateImpacts() {
      const tempChange = parseFloat(tempSlider.value);
      const precipChange = parseInt(precipSlider.value);

      tempValueSpan.textContent = tempChange.toFixed(1);
      precipValueSpan.textContent = precipChange;

      // Reset classes
      impactPeople.className = 'impact-category';
      impactAgriculture.className = 'impact-category';
      impactEconomy.className = 'impact-category';

      // Impact on People
      let peopleImpactText = "";
      if (tempChange < 0.5 && precipChange >= -5 && precipChange <= 5) {
        peopleImpactText = "In uno scenario di cambiamenti minimi, l'impatto sulla salute pubblica rimane gestibile, con condizioni di benessere simili a quelle attuali, sebbene con attenzione alle fasce più sensibili.";
        impactPeople.classList.add('positive');
      } else if (tempChange >= 0.5 && tempChange < 2) {
        peopleImpactText = "L'aumento delle temperature medie e la maggiore frequenza di ondate di calore (legate a TR, TX90p) portano a un moderato stress termico. Aumentano i disagi estivi e i rischi per la salute delle categorie vulnerabili, richiedendo un potenziamento dei servizi di supporto.";
        impactPeople.classList.add('warning');
      } else { // tempChange >= 2
        peopleImpactText = "Un aumento significativo delle temperature e ondate di calore prolungate (HWF/HWN) causano un elevato stress termico e un forte incremento di patologie correlate al calore. La qualità della vita urbana diminuisce e i sistemi sanitari sono messi a dura prova, con impatti estesi su tutta la popolazione.";
        impactPeople.classList.add('negative');
      }
      impactPeople.querySelector('p').textContent = peopleImpactText;

      // Impact on Agriculture
      let agricultureImpactText = "";
      if (tempChange < 0.5 && precipChange >= -5 && precipChange <= 5) {
        agricultureImpactText = "Le condizioni climatiche rimangono favorevoli all'agricoltura locale, con rese stabili e costi di gestione idrica contenuti. Potrebbero essere necessarie solo lievi modifiche alle pratiche agricole.";
        impactAgriculture.classList.add('positive');
      } else if ((tempChange >= 0.5 && tempChange < 1.5) || (precipChange < -5 && precipChange >= -15) || (precipChange > 5 && precipChange <= 15)) {
        agricultureImpactText = "L'aumento dei periodi di siccità (CDD) o le precipitazioni più intense (R95p) mettono a rischio le colture tipiche come il riso e il mais. Richiede maggiori investimenti in sistemi di irrigazione efficienti e l'introduzione di varietà più resilienti, con costi operativi in aumento e potenziale impatto sulle rese.";
        impactAgriculture.classList.add('warning');
      } else { // tempChange >= 1.5 or precipChange < -15 or precipChange > 15
        agricultureImpactText = "Scenario critico: ondate di calore prolungate (TXGE30), siccità estreme e piogge torrenziali causano gravi perdite di raccolto e danni infrastrutturali. L'agricoltura vercellese subisce un forte stress, con costi esorbitanti e la necessità di una radicale riconversione o abbandono di alcune produzioni.";
        impactAgriculture.classList.add('negative');
      }
      impactAgriculture.querySelector('p').textContent = agricultureImpactText;

      // Impact on Economy
      let economyImpactText = "";
      if (tempChange < 0.5 && precipChange >= -5 && precipChange <= 5) {
        economyImpactText = "L'economia locale mantiene la sua resilienza, con impatti climatici minimi che non alterano significativamente i settori chiave. Potrebbero emergere opportunità legate a investimenti in sostenibilità.";
        impactEconomy.classList.add('positive');
      } else if ((tempChange >= 0.5 && tempChange < 1.5) || (Math.abs(precipChange) > 5 && Math.abs(precipChange) <= 15)) {
        economyImpactText = "Costi crescenti per l'adattamento in agricoltura e infrastrutture. L'aumento dei costi energetici per il raffrescamento e i potenziali danni da eventi estremi (R95p) impongono una maggiore spesa pubblica e privata, con un impatto moderato sulla crescita economica locale.";
        impactEconomy.classList.add('warning');
      } else { // tempChange >= 1.5 or Math.abs(precipChange) > 15
        economyImpactText = "Rischio economico elevato. La diminuzione della produttività agricola, i costi sanitari elevati e i danni estesi alle infrastrutture causano significative perdite economiche. La competitività del territorio è compromessa e si verifica una potenziale perdita di posti di lavoro, influenzando negativamente il benessere sociale.";
        impactEconomy.classList.add('negative');
      }
      impactEconomy.querySelector('p').textContent = economyImpactText;
    }

    tempSlider.addEventListener('input', updateImpacts);
    precipSlider.addEventListener('input', updateImpacts);

    // Initial update when the page loads
    updateImpacts();
  </script>
</body>
</html>
